---
import { useState } from 'astro:content';

// Function to handle file upload
const handleUpload = async (event) => {
  const file = event.target.files[0];
  if (!file) return;

  // Creating FormData to send file
  const formData = new FormData();
  formData.append('file', file);

  try {
    const response = await fetch('/api/upload', {
      method: 'POST',
      body: formData,
    });

    const result = await response.json();
    alert(result.message || 'File uploaded successfully!');
  } catch (error) {
    alert('Upload failed. Please try again.');
  }
};
---

<head>
  <title>Upload Page</title>
</head>

<body>
  <h1>Upload an Image</h1>
  
  <form id="uploadForm">
    <input type="file" id="fileInput" accept="image/*" />
    <button type="button" onclick="uploadFile()">Upload</button>
  </form>

  <script>
    async function uploadFile() {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
      if (!file) return alert('Please select a file');

      const formData = new FormData();
      formData.append('file', file);

      try {
        const response = await fetch('/api/upload', {
          method: 'POST',
          body: formData,
        });

        const result = await response.json();
        alert(result.message || 'File uploaded successfully!');
      } catch (error) {
        alert('Upload failed. Please try again.');
      }
    }
  </script>
</body>
